{"ast":null,"code":"import React,{useState}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import{Container,Typography,Paper,Box,Button,CircularProgress,Alert}from'@mui/material';import CloudUploadIcon from'@mui/icons-material/CloudUpload';import ImageIcon from'@mui/icons-material/Image';import ImageGuidelines from'../components/ImageGuidelines';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UploadPage=()=>{const navigate=useNavigate();const[file,setFile]=useState(null);const[preview,setPreview]=useState(null);const[loading,setLoading]=useState(false);const[error,setError]=useState('');const handleFileChange=e=>{const selectedFile=e.target.files[0];if(!selectedFile)return;setFile(selectedFile);setError('');// Create preview\nconst reader=new FileReader();reader.onloadend=()=>{setPreview(reader.result);};reader.readAsDataURL(selectedFile);};const handleDragOver=e=>{e.preventDefault();};const handleDrop=e=>{e.preventDefault();const selectedFile=e.dataTransfer.files[0];if(!selectedFile)return;// Check if the file is an image\nif(!selectedFile.type.startsWith('image/')){setError('Please upload an image file (JPEG, PNG)');return;}setFile(selectedFile);setError('');// Create preview\nconst reader=new FileReader();reader.onloadend=()=>{setPreview(reader.result);};reader.readAsDataURL(selectedFile);};const handleSubmit=async()=>{if(!file){setError('Please select an image to upload');return;}// Check file size (max 10MB)\nif(file.size>10*1024*1024){setError('Image size too large. Please upload an image smaller than 10MB');return;}setLoading(true);setError('');const formData=new FormData();formData.append('image',file);try{const response=await axios.post('/api/analyze',formData,{headers:{'Content-Type':'multipart/form-data'},timeout:60000// Increase timeout to 60 seconds for large images\n});if(response.data&&response.data.id){navigate(\"/dashboard/\".concat(response.data.id));}else{setError('Error processing the image. Please try another one.');}}catch(err){console.error('Image analysis error:',err);// Provide more specific error messages based on the error\nif(err.response){var _err$response$data;// Server responded with an error\nconst serverError=((_err$response$data=err.response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||'Unknown server error';setError(\"Error: \".concat(serverError));}else if(err.request){// Request was made but no response received\nsetError('Server not responding. Please check your internet connection and try again.');}else{// Error in setting up the request\nsetError('Error analyzing the image. Please try a different image or format (JPEG/PNG).');}}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(Container,{maxWidth:\"md\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",gutterBottom:true,align:\"center\",children:\"Upload Fitness Data Image\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",paragraph:true,align:\"center\",children:\"Upload a screenshot of your fitness tracker summary to get personalized health insights and recommendations.\"}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:3},children:error}),/*#__PURE__*/_jsxs(Paper,{sx:{p:3,mb:3,display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',border:'2px dashed #ccc',borderRadius:2,minHeight:300,cursor:'pointer'},onDragOver:handleDragOver,onDrop:handleDrop,onClick:()=>document.getElementById('file-input').click(),children:[/*#__PURE__*/_jsx(\"input\",{id:\"file-input\",type:\"file\",accept:\"image/*\",onChange:handleFileChange,style:{display:'none'}}),preview?/*#__PURE__*/_jsxs(Box,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(\"img\",{src:preview,alt:\"Preview\",style:{maxWidth:'100%',maxHeight:300,marginBottom:16}}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:file===null||file===void 0?void 0:file.name})]}):/*#__PURE__*/_jsxs(Box,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(ImageIcon,{sx:{fontSize:80,color:'text.secondary',mb:2}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Drag & drop an image here or click to browse\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Supported formats: JPEG, PNG\"})]})]}),/*#__PURE__*/_jsx(ImageGuidelines,{}),/*#__PURE__*/_jsx(Box,{sx:{textAlign:'center'},children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",size:\"large\",startIcon:loading?/*#__PURE__*/_jsx(CircularProgress,{size:24,color:\"inherit\"}):/*#__PURE__*/_jsx(CloudUploadIcon,{}),onClick:handleSubmit,disabled:!file||loading,children:loading?'Analyzing...':'Analyze Image'})})]});};export default UploadPage;","map":{"version":3,"names":["React","useState","useNavigate","axios","Container","Typography","Paper","Box","Button","CircularProgress","Alert","CloudUploadIcon","ImageIcon","ImageGuidelines","jsx","_jsx","jsxs","_jsxs","UploadPage","navigate","file","setFile","preview","setPreview","loading","setLoading","error","setError","handleFileChange","e","selectedFile","target","files","reader","FileReader","onloadend","result","readAsDataURL","handleDragOver","preventDefault","handleDrop","dataTransfer","type","startsWith","handleSubmit","size","formData","FormData","append","response","post","headers","timeout","data","id","concat","err","console","_err$response$data","serverError","request","maxWidth","children","variant","component","gutterBottom","align","paragraph","severity","sx","mb","p","display","flexDirection","alignItems","justifyContent","border","borderRadius","minHeight","cursor","onDragOver","onDrop","onClick","document","getElementById","click","accept","onChange","style","textAlign","src","alt","maxHeight","marginBottom","color","name","fontSize","startIcon","disabled"],"sources":["C:/Users/Nitish Maurya/Desktop/frontend/src/pages/UploadPage.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { \n  Container, \n  Typography, \n  Paper, \n  Box, \n  Button, \n  CircularProgress,\n  Alert\n} from '@mui/material';\nimport CloudUploadIcon from '@mui/icons-material/CloudUpload';\nimport ImageIcon from '@mui/icons-material/Image';\nimport ImageGuidelines from '../components/ImageGuidelines';\n\nconst UploadPage = () => {\n  const navigate = useNavigate();\n  const [file, setFile] = useState(null);\n  const [preview, setPreview] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const handleFileChange = (e) => {\n    const selectedFile = e.target.files[0];\n    if (!selectedFile) return;\n    \n    setFile(selectedFile);\n    setError('');\n    \n    // Create preview\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      setPreview(reader.result);\n    };\n    reader.readAsDataURL(selectedFile);\n  };\n\n  const handleDragOver = (e) => {\n    e.preventDefault();\n  };\n\n  const handleDrop = (e) => {\n    e.preventDefault();\n    const selectedFile = e.dataTransfer.files[0];\n    if (!selectedFile) return;\n    \n    // Check if the file is an image\n    if (!selectedFile.type.startsWith('image/')) {\n      setError('Please upload an image file (JPEG, PNG)');\n      return;\n    }\n    \n    setFile(selectedFile);\n    setError('');\n    \n    // Create preview\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      setPreview(reader.result);\n    };\n    reader.readAsDataURL(selectedFile);\n  };\n\n  const handleSubmit = async () => {\n    if (!file) {\n      setError('Please select an image to upload');\n      return;\n    }\n    \n    // Check file size (max 10MB)\n    if (file.size > 10 * 1024 * 1024) {\n      setError('Image size too large. Please upload an image smaller than 10MB');\n      return;\n    }\n\n    setLoading(true);\n    setError('');\n    \n    const formData = new FormData();\n    formData.append('image', file);\n    \n    try {\n      const response = await axios.post('/api/analyze', formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        },\n        timeout: 60000 // Increase timeout to 60 seconds for large images\n      });\n      \n      if (response.data && response.data.id) {\n        navigate(`/dashboard/${response.data.id}`);\n      } else {\n        setError('Error processing the image. Please try another one.');\n      }\n    } catch (err) {\n      console.error('Image analysis error:', err);\n      \n      // Provide more specific error messages based on the error\n      if (err.response) {\n        // Server responded with an error\n        const serverError = err.response.data?.error || 'Unknown server error';\n        setError(`Error: ${serverError}`);\n      } else if (err.request) {\n        // Request was made but no response received\n        setError('Server not responding. Please check your internet connection and try again.');\n      } else {\n        // Error in setting up the request\n        setError('Error analyzing the image. Please try a different image or format (JPEG/PNG).');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <Container maxWidth=\"md\">\n      <Typography variant=\"h4\" component=\"h1\" gutterBottom align=\"center\">\n        Upload Fitness Data Image\n      </Typography>\n      \n      <Typography variant=\"body1\" paragraph align=\"center\">\n        Upload a screenshot of your fitness tracker summary to get personalized health insights and recommendations.\n      </Typography>\n      \n      {error && (\n        <Alert severity=\"error\" sx={{ mb: 3 }}>{error}</Alert>\n      )}\n      \n      <Paper \n        sx={{ \n          p: 3, \n          mb: 3, \n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'center',\n          border: '2px dashed #ccc',\n          borderRadius: 2,\n          minHeight: 300,\n          cursor: 'pointer'\n        }}\n        onDragOver={handleDragOver}\n        onDrop={handleDrop}\n        onClick={() => document.getElementById('file-input').click()}\n      >\n        <input\n          id=\"file-input\"\n          type=\"file\"\n          accept=\"image/*\"\n          onChange={handleFileChange}\n          style={{ display: 'none' }}\n        />\n        \n        {preview ? (\n          <Box sx={{ textAlign: 'center' }}>\n            <img \n              src={preview} \n              alt=\"Preview\" \n              style={{ maxWidth: '100%', maxHeight: 300, marginBottom: 16 }} \n            />\n            <Typography variant=\"body2\" color=\"text.secondary\">\n              {file?.name}\n            </Typography>\n          </Box>\n        ) : (\n          <Box sx={{ textAlign: 'center' }}>\n            <ImageIcon sx={{ fontSize: 80, color: 'text.secondary', mb: 2 }} />\n            <Typography variant=\"h6\" gutterBottom>\n              Drag & drop an image here or click to browse\n            </Typography>\n            <Typography variant=\"body2\" color=\"text.secondary\">\n              Supported formats: JPEG, PNG\n            </Typography>\n          </Box>\n        )}\n      </Paper>\n      \n      <ImageGuidelines />\n      \n      <Box sx={{ textAlign: 'center' }}>\n        <Button\n          variant=\"contained\"\n          color=\"primary\"\n          size=\"large\"\n          startIcon={loading ? <CircularProgress size={24} color=\"inherit\" /> : <CloudUploadIcon />}\n          onClick={handleSubmit}\n          disabled={!file || loading}\n        >\n          {loading ? 'Analyzing...' : 'Analyze Image'}\n        </Button>\n      </Box>\n    </Container>\n  );\n};\n\nexport default UploadPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}